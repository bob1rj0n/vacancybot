"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.adminScene = void 0;
const telegraf_1 = require("telegraf");
const messages_1 = require("../../../common/constant/messages");
const SceneName_1 = require("../../../common/constant/SceneName");
const findHrVacansy_model_1 = require("../../../common/db/model/findHrVacansy.model");
const user_model_1 = require("../../../common/db/model/user.model");
const vacancy_model_1 = require("../../../common/db/model/vacancy.model");
const bot_plugin_1 = require("../../plugins/bot.plugin");
exports.adminScene = new telegraf_1.Scenes.BaseScene(SceneName_1.SceneNames.ADMIN);
exports.adminScene.enter(async (ctx) => {
});
exports.adminScene.action('‚úÖ', async (ctx) => {
    await ctx.editMessageReplyMarkup({ inline_keyboard: [] });
    let Msg, msg;
    const a = (await vacancy_model_1.VacancyModel.find({ messageId: ctx.callbackQuery.message.message_id })).shift();
    const b = (await findHrVacansy_model_1.FindHrVacansyModel.find({ messageId: ctx.callbackQuery.message.message_id })).shift();
    Msg = a ? a : b;
    const user = (await user_model_1.UserModel.find({ userId: Msg.userId })).shift();
    if (Msg.type == 'findWork') {
        msg = (`
Ish joyi kerak:

üë®‚Äçüíº Xodim: ${Msg.name}
üïë Yosh: ${Msg.age}
üë®‚Äçüíª <b>Yo'nalish: ${Msg.direction}</b>
üìö Texnologiya: ${Msg.technology}
üá∫üáø Telegram: @${Msg.tgUsername} 
üìû Aloqa: ${Msg.phone}
üåê Hudud: ${Msg.place}
üí∞ Maosh: ${Msg.price}
üë®üèª‚Äçüíª Kasbi: ${Msg.profession}
üï∞ Murojaat qilish vaqti: ${Msg.timeToCall}
üîé Maqsad: ${Msg.goal}

¬© @${ctx.botInfo.username}
        `);
    }
    if (Msg.type == 'findHr') {
        msg = (`
Xodim kerak:

üè¢ Idora: ${Msg.officeName}
üë®‚Äçüíª <b>Yo'nalish: ${Msg.direction}</b>
üìö Texnologiya: ${Msg.technology}
üá∫üáø Telegram: @${Msg.tgUsername} 
üåê Hudud: ${Msg.place}
‚úçÔ∏è Mas'ul: ${Msg.responsible}
üï∞ Murojaat vaqti: ${Msg.timeToCall}
üï∞ Ish vaqti: ${Msg.timeOfWork}
üí∞ Maosh: ${Msg.price}

¬© @${ctx.botInfo.username}
        `);
    }
    const vacCahn = await ctx.telegram.sendPhoto("@IT_vacansy", {
        source: Msg.img
    }, {
        caption: msg,
        parse_mode: "HTML"
    });
    await bot_plugin_1.bot.telegram.sendMessage(Msg.userId, messages_1.Messages.PostedByAdmin[user.language], {
        parse_mode: "HTML",
        reply_to_message_id: Msg.userMsgId,
        reply_markup: {
            inline_keyboard: [
                [
                    {
                        text: "Link", url: `https://t.me/IT_vacansy/${vacCahn.message_id}`
                    }
                ]
            ]
        }
    });
    await ctx.replyWithHTML(`Vakansiya kanalga joylandi!`);
});
exports.adminScene.action('‚ùå', async (ctx) => {
    await ctx.editMessageReplyMarkup({ inline_keyboard: [] });
    const Msg = (await vacancy_model_1.VacancyModel.find({ messageId: ctx.callbackQuery.message.message_id })).shift();
    ctx.session.rejectedMsg = Msg;
    await ctx.scene.enter(SceneName_1.SceneNames.REJECT_VACANSY);
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWRtaW4uc2NlbmUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvYm90L3NuZWNlLzIuc2NlbmVzL2FkbWluLnNjZW5lLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLHVDQUEwQztBQUMxQyxnRUFBNkQ7QUFDN0Qsa0VBQWdFO0FBQ2hFLHNGQUFrRjtBQUNsRixvRUFBZ0U7QUFDaEUsMEVBQXNFO0FBQ3RFLHlEQUEwRDtBQUc3QyxRQUFBLFVBQVUsR0FBRyxJQUFJLGlCQUFNLENBQUMsU0FBUyxDQUFZLHNCQUFVLENBQUMsS0FBSyxDQUFDLENBQUE7QUFFM0Usa0JBQVUsQ0FBQyxLQUFLLENBQUMsS0FBSyxFQUFFLEdBQUcsRUFBRSxFQUFFO0FBQy9CLENBQUMsQ0FBQyxDQUFBO0FBQ0Ysa0JBQVUsQ0FBQyxNQUFNLENBQUMsR0FBRyxFQUFFLEtBQUssRUFBQyxHQUFHLEVBQUMsRUFBRTtJQUMvQixNQUFNLEdBQUcsQ0FBQyxzQkFBc0IsQ0FBQyxFQUFFLGVBQWUsRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFBO0lBRXpELElBQUksR0FBRyxFQUFFLEdBQUcsQ0FBQztJQUNiLE1BQU0sQ0FBQyxHQUFHLENBQUMsTUFBTSw0QkFBWSxDQUFDLElBQUksQ0FBQyxFQUFFLFNBQVMsRUFBRSxHQUFHLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDakcsTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLHdDQUFrQixDQUFDLElBQUksQ0FBQyxFQUFFLFNBQVMsRUFBRSxHQUFHLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDdkcsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDaEIsTUFBTSxJQUFJLEdBQUcsQ0FBQyxNQUFNLHNCQUFTLENBQUMsSUFBSSxDQUFDLEVBQUUsTUFBTSxFQUFFLEdBQUcsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDcEUsSUFBSSxHQUFHLENBQUMsSUFBSSxJQUFJLFVBQVUsRUFBRTtRQUN4QixHQUFHLEdBQUcsQ0FBQzs7O2VBR0EsR0FBRyxDQUFDLElBQUk7V0FDWixHQUFHLENBQUMsR0FBRztzQkFDSSxHQUFHLENBQUMsU0FBUztrQkFDakIsR0FBRyxDQUFDLFVBQVU7a0JBQ2QsR0FBRyxDQUFDLFVBQVU7WUFDcEIsR0FBRyxDQUFDLEtBQUs7WUFDVCxHQUFHLENBQUMsS0FBSztZQUNULEdBQUcsQ0FBQyxLQUFLO2lCQUNKLEdBQUcsQ0FBQyxVQUFVOzRCQUNILEdBQUcsQ0FBQyxVQUFVO2FBQzdCLEdBQUcsQ0FBQyxJQUFJOztLQUVoQixHQUFHLENBQUMsT0FBTyxDQUFDLFFBQVE7U0FDaEIsQ0FBQyxDQUFBO0tBQ0w7SUFDRCxJQUFJLEdBQUcsQ0FBQyxJQUFJLElBQUksUUFBUSxFQUFFO1FBQ3RCLEdBQUcsR0FBRyxDQUFDOzs7WUFHSCxHQUFHLENBQUMsVUFBVTtzQkFDSixHQUFHLENBQUMsU0FBUztrQkFDakIsR0FBRyxDQUFDLFVBQVU7a0JBQ2QsR0FBRyxDQUFDLFVBQVU7WUFDcEIsR0FBRyxDQUFDLEtBQUs7YUFDUixHQUFHLENBQUMsV0FBVztxQkFDUCxHQUFHLENBQUMsVUFBVTtnQkFDbkIsR0FBRyxDQUFDLFVBQVU7WUFDbEIsR0FBRyxDQUFDLEtBQUs7O0tBRWhCLEdBQUcsQ0FBQyxPQUFPLENBQUMsUUFBUTtTQUNoQixDQUFDLENBQUE7S0FDTDtJQUNELE1BQU0sT0FBTyxHQUFHLE1BQU0sR0FBRyxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQ3hDLGFBQWEsRUFDYjtRQUNJLE1BQU0sRUFBRSxHQUFHLENBQUMsR0FBRztLQUNsQixFQUNEO1FBQ0ksT0FBTyxFQUFFLEdBQUc7UUFDWixVQUFVLEVBQUUsTUFBTTtLQUNyQixDQUNKLENBQUM7SUFFRixNQUFNLGdCQUFHLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FDMUIsR0FBRyxDQUFDLE1BQU0sRUFDVixtQkFBUSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQ3JDO1FBQ0ksVUFBVSxFQUFFLE1BQU07UUFDbEIsbUJBQW1CLEVBQUUsR0FBRyxDQUFDLFNBQVM7UUFDbEMsWUFBWSxFQUFFO1lBQ1YsZUFBZSxFQUFFO2dCQUNiO29CQUNJO3dCQUNJLElBQUksRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLDJCQUEyQixPQUFPLENBQUMsVUFBVSxFQUFFO3FCQUNyRTtpQkFDSjthQUNKO1NBQ0o7S0FDSixDQUNKLENBQUE7SUFDRCxNQUFNLEdBQUcsQ0FBQyxhQUFhLENBQUMsNkJBQTZCLENBQUMsQ0FBQTtBQUMxRCxDQUFDLENBQUMsQ0FBQTtBQUdGLGtCQUFVLENBQUMsTUFBTSxDQUFDLEdBQUcsRUFBRSxLQUFLLEVBQUMsR0FBRyxFQUFDLEVBQUU7SUFDL0IsTUFBTSxHQUFHLENBQUMsc0JBQXNCLENBQUMsRUFBRSxlQUFlLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQTtJQUV6RCxNQUFNLEdBQUcsR0FBRyxDQUFDLE1BQU0sNEJBQVksQ0FBQyxJQUFJLENBQUMsRUFBRSxTQUFTLEVBQUUsR0FBRyxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDO0lBRW5HLEdBQUcsQ0FBQyxPQUFPLENBQUMsV0FBVyxHQUFHLEdBQUcsQ0FBQztJQUM5QixNQUFNLEdBQUcsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLHNCQUFVLENBQUMsY0FBYyxDQUFDLENBQUM7QUFDckQsQ0FBQyxDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBNYXJrdXAsIFNjZW5lcyB9IGZyb20gXCJ0ZWxlZ3JhZlwiO1xyXG5pbXBvcnQgeyBNZXNzYWdlcyB9IGZyb20gXCIuLi8uLi8uLi9jb21tb24vY29uc3RhbnQvbWVzc2FnZXNcIjtcclxuaW1wb3J0IHsgU2NlbmVOYW1lcyB9IGZyb20gXCIuLi8uLi8uLi9jb21tb24vY29uc3RhbnQvU2NlbmVOYW1lXCI7XHJcbmltcG9ydCB7IEZpbmRIclZhY2Fuc3lNb2RlbCB9IGZyb20gXCIuLi8uLi8uLi9jb21tb24vZGIvbW9kZWwvZmluZEhyVmFjYW5zeS5tb2RlbFwiO1xyXG5pbXBvcnQgeyBVc2VyTW9kZWwgfSBmcm9tIFwiLi4vLi4vLi4vY29tbW9uL2RiL21vZGVsL3VzZXIubW9kZWxcIjtcclxuaW1wb3J0IHsgVmFjYW5jeU1vZGVsIH0gZnJvbSBcIi4uLy4uLy4uL2NvbW1vbi9kYi9tb2RlbC92YWNhbmN5Lm1vZGVsXCI7XHJcbmltcG9ydCB7IGJvdCwgTXlDb250ZXh0IH0gZnJvbSBcIi4uLy4uL3BsdWdpbnMvYm90LnBsdWdpblwiO1xyXG5cclxuXHJcbmV4cG9ydCBjb25zdCBhZG1pblNjZW5lID0gbmV3IFNjZW5lcy5CYXNlU2NlbmU8TXlDb250ZXh0PihTY2VuZU5hbWVzLkFETUlOKVxyXG5cclxuYWRtaW5TY2VuZS5lbnRlcihhc3luYyAoY3R4KSA9PiB7XHJcbn0pXHJcbmFkbWluU2NlbmUuYWN0aW9uKCfinIUnLCBhc3luYyBjdHggPT4ge1xyXG4gICAgYXdhaXQgY3R4LmVkaXRNZXNzYWdlUmVwbHlNYXJrdXAoeyBpbmxpbmVfa2V5Ym9hcmQ6IFtdIH0pXHJcblxyXG4gICAgbGV0IE1zZywgbXNnO1xyXG4gICAgY29uc3QgYSA9IChhd2FpdCBWYWNhbmN5TW9kZWwuZmluZCh7IG1lc3NhZ2VJZDogY3R4LmNhbGxiYWNrUXVlcnkubWVzc2FnZS5tZXNzYWdlX2lkIH0pKS5zaGlmdCgpO1xyXG4gICAgY29uc3QgYiA9IChhd2FpdCBGaW5kSHJWYWNhbnN5TW9kZWwuZmluZCh7IG1lc3NhZ2VJZDogY3R4LmNhbGxiYWNrUXVlcnkubWVzc2FnZS5tZXNzYWdlX2lkIH0pKS5zaGlmdCgpO1xyXG4gICAgTXNnID0gYSA/IGEgOiBiO1xyXG4gICAgY29uc3QgdXNlciA9IChhd2FpdCBVc2VyTW9kZWwuZmluZCh7IHVzZXJJZDogTXNnLnVzZXJJZCB9KSkuc2hpZnQoKTtcclxuICAgIGlmIChNc2cudHlwZSA9PSAnZmluZFdvcmsnKSB7XHJcbiAgICAgICAgbXNnID0gKGBcclxuSXNoIGpveWkga2VyYWs6XHJcblxyXG7wn5Go4oCN8J+SvCBYb2RpbTogJHtNc2cubmFtZX1cclxu8J+VkSBZb3NoOiAke01zZy5hZ2V9XHJcbvCfkajigI3wn5K7IDxiPllvJ25hbGlzaDogJHtNc2cuZGlyZWN0aW9ufTwvYj5cclxu8J+TmiBUZXhub2xvZ2l5YTogJHtNc2cudGVjaG5vbG9neX1cclxu8J+HuvCfh78gVGVsZWdyYW06IEAke01zZy50Z1VzZXJuYW1lfSBcclxu8J+TniBBbG9xYTogJHtNc2cucGhvbmV9XHJcbvCfjJAgSHVkdWQ6ICR7TXNnLnBsYWNlfVxyXG7wn5KwIE1hb3NoOiAke01zZy5wcmljZX1cclxu8J+RqPCfj7vigI3wn5K7IEthc2JpOiAke01zZy5wcm9mZXNzaW9ufVxyXG7wn5WwIE11cm9qYWF0IHFpbGlzaCB2YXF0aTogJHtNc2cudGltZVRvQ2FsbH1cclxu8J+UjiBNYXFzYWQ6ICR7TXNnLmdvYWx9XHJcblxyXG7CqSBAJHtjdHguYm90SW5mby51c2VybmFtZX1cclxuICAgICAgICBgKVxyXG4gICAgfVxyXG4gICAgaWYgKE1zZy50eXBlID09ICdmaW5kSHInKSB7XHJcbiAgICAgICAgbXNnID0gKGBcclxuWG9kaW0ga2VyYWs6XHJcblxyXG7wn4+iIElkb3JhOiAke01zZy5vZmZpY2VOYW1lfVxyXG7wn5Go4oCN8J+SuyA8Yj5ZbyduYWxpc2g6ICR7TXNnLmRpcmVjdGlvbn08L2I+XHJcbvCfk5ogVGV4bm9sb2dpeWE6ICR7TXNnLnRlY2hub2xvZ3l9XHJcbvCfh7rwn4e/IFRlbGVncmFtOiBAJHtNc2cudGdVc2VybmFtZX0gXHJcbvCfjJAgSHVkdWQ6ICR7TXNnLnBsYWNlfVxyXG7inI3vuI8gTWFzJ3VsOiAke01zZy5yZXNwb25zaWJsZX1cclxu8J+VsCBNdXJvamFhdCB2YXF0aTogJHtNc2cudGltZVRvQ2FsbH1cclxu8J+VsCBJc2ggdmFxdGk6ICR7TXNnLnRpbWVPZldvcmt9XHJcbvCfkrAgTWFvc2g6ICR7TXNnLnByaWNlfVxyXG5cclxuwqkgQCR7Y3R4LmJvdEluZm8udXNlcm5hbWV9XHJcbiAgICAgICAgYClcclxuICAgIH1cclxuICAgIGNvbnN0IHZhY0NhaG4gPSBhd2FpdCBjdHgudGVsZWdyYW0uc2VuZFBob3RvKFxyXG4gICAgICAgIFwiQElUX3ZhY2Fuc3lcIixcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHNvdXJjZTogTXNnLmltZ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBjYXB0aW9uOiBtc2csXHJcbiAgICAgICAgICAgIHBhcnNlX21vZGU6IFwiSFRNTFwiXHJcbiAgICAgICAgfVxyXG4gICAgKTtcclxuXHJcbiAgICBhd2FpdCBib3QudGVsZWdyYW0uc2VuZE1lc3NhZ2UoXHJcbiAgICAgICAgTXNnLnVzZXJJZCxcclxuICAgICAgICBNZXNzYWdlcy5Qb3N0ZWRCeUFkbWluW3VzZXIubGFuZ3VhZ2VdLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcGFyc2VfbW9kZTogXCJIVE1MXCIsXHJcbiAgICAgICAgICAgIHJlcGx5X3RvX21lc3NhZ2VfaWQ6IE1zZy51c2VyTXNnSWQsXHJcbiAgICAgICAgICAgIHJlcGx5X21hcmt1cDoge1xyXG4gICAgICAgICAgICAgICAgaW5saW5lX2tleWJvYXJkOiBbXHJcbiAgICAgICAgICAgICAgICAgICAgW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcIkxpbmtcIiwgdXJsOiBgaHR0cHM6Ly90Lm1lL0lUX3ZhY2Fuc3kvJHt2YWNDYWhuLm1lc3NhZ2VfaWR9YFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgXVxyXG4gICAgICAgICAgICAgICAgXVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgKVxyXG4gICAgYXdhaXQgY3R4LnJlcGx5V2l0aEhUTUwoYFZha2Fuc2l5YSBrYW5hbGdhIGpveWxhbmRpIWApXHJcbn0pXHJcblxyXG5cclxuYWRtaW5TY2VuZS5hY3Rpb24oJ+KdjCcsIGFzeW5jIGN0eCA9PiB7XHJcbiAgICBhd2FpdCBjdHguZWRpdE1lc3NhZ2VSZXBseU1hcmt1cCh7IGlubGluZV9rZXlib2FyZDogW10gfSlcclxuXHJcbiAgICBjb25zdCBNc2cgPSAoYXdhaXQgVmFjYW5jeU1vZGVsLmZpbmQoeyBtZXNzYWdlSWQ6IGN0eC5jYWxsYmFja1F1ZXJ5Lm1lc3NhZ2UubWVzc2FnZV9pZCB9KSkuc2hpZnQoKTtcclxuXHJcbiAgICBjdHguc2Vzc2lvbi5yZWplY3RlZE1zZyA9IE1zZztcclxuICAgIGF3YWl0IGN0eC5zY2VuZS5lbnRlcihTY2VuZU5hbWVzLlJFSkVDVF9WQUNBTlNZKTtcclxufSlcclxuIl19